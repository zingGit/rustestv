window.__require=function e(t,i,n){function o(l,r){if(!i[l]){if(!t[l]){var s=l.split("/");if(s=s[s.length-1],!t[s]){var c="function"==typeof __require&&__require;if(!r&&c)return c(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+l+"'")}l=s}var p=i[l]={exports:{}};t[l][0].call(p.exports,function(e){return o(t[l][1][e]||e)},p,p.exports,e,t,i,n)}return i[l].exports}for(var a="function"==typeof __require&&__require,l=0;l<n.length;l++)o(n[l]);return o}({RabbitSlotsContentCom:[function(e,t,i){"use strict";cc._RF.push(t,"f653f8XswFEk49loAGjfzV0","RabbitSlotsContentCom");var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,l=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(a<3?o(l):a>3?o(t,i,l):o(t,i))||l);return a>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("../../Script/BaseSlot/RollState"),r=e("../../Script/BaseSlot/SlotBaseContentCom"),s=e("../../Script/BaseSlot/SlotEvent"),c=e("../../Script/BaseSlot/SlotGameCfg"),p=e("../../Script/BaseSlot/SlotTool"),h=e("../../Script/Core/Analytics/AnalyticsCfg"),u=e("../../Script/Core/Analytics/AnalyticsMgr"),d=e("../../Script/Core/Event/GlobalEvent"),f=e("../../Script/Core/Module/GameData"),m=e("../../Script/Core/Net/SlotNetWorkReq"),_=e("../../Script/Core/Net/SocketMgr"),y=e("../../Script/Core/Tool/CommonFun"),v=e("../../Script/Core/Tool/MathTool"),b=e("../../Script/Core/Tool/SoundMgr"),C=e("../../Script/app/data"),S=e("./RabbitSlotsItemCom"),g=e("./RabbitSlotsRowCom"),N=cc._decorator,w=N.ccclass,A=N.property,B=[{lineId:1,serverPos:[1,2,3]},{lineId:2,serverPos:[1,3,5]},{lineId:3,serverPos:[1,5,6]},{lineId:4,serverPos:[3,4,5]},{lineId:5,serverPos:[4,5,6]},{lineId:6,serverPos:[4,6,8]},{lineId:7,serverPos:[4,8,9]},{lineId:8,serverPos:[6,7,8]},{lineId:9,serverPos:[7,8,9]},{lineId:10,serverPos:[7,9,11]}],I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.row=null,t.elemtScroll=null,t.scrollEndClip=null,t.bgmRabbitClip=null,t.moneyAppearClip=null,t.wildAppearClip=null,t.freeMoneyClipAry=[],t.rabbitReadyClip=null,t.pfLineNum=null,t.pfWinAnimBg=null,t.pfElemItem=null,t.labelLineScore=null,t.pfMoneyParticle=null,t.pfMoneySpineLight=null,t.pfFreeMoney=null,t._itemRows=[],t._luckyPos=[],t._completeCount=0,t._betValue=0,t._spinBtn=null,t._stopBtn=null,t._scrollAudioId=-1,t._levelId=0,t.bFree=!1,t.rabbitSpine=null,t.lastSpinSecs=0,t.curMoneyIdAry=[],t.curMoneyPosAry=[],t}return o(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),d.GlobalEvent.on(s.default.RollState_Complete,this.onRollComplete,this),d.GlobalEvent.on(s.default.UpdateBetValue,this.onUpdateBetValue,this),d.GlobalEvent.on(s.default.Click_Spin,this.onSpin,this),d.GlobalEvent.on(s.default.Click_Stop,this.onStop,this),d.GlobalEvent.on(s.default.UpdateSlotData,this.initRowItem,this),d.GlobalEvent.on(s.default.Click_SpinTest,this.onSpinTest,this),d.GlobalEvent.on("RabbitFreeGame",this.onEventFreeGame,this),d.GlobalEvent.on("RabbitFreeMoneyFall",this.onEventMoneyFall,this),_.default.init(this,["SpinSlotRsp"],["SpinSlotRsp"])},t.prototype.start=function(){var e=this;this._levelId=f.default.getSlotGameData().level.level_id,this._betValue=Number(f.default.getSlotGameData().prev_base)?Number(f.default.getSlotGameData().prev_base):Number(f.default.getSlotGameData().level.bets[0]),this.initRowItem();var t=cc.instantiate(this.pfLineNum);t.name="nodeLineNum",this._nodeLine.addChild(t),this.rabbitSpine=this._nodeRabbit.getComponent(sp.Skeleton),cc.tween(this.node).delay(1).call(function(){e.lastSpinSecs++,e.lastSpinSecs>0&&e.lastSpinSecs%20==0&&(e.rabbitSpine.setAnimation(0,"idle3",!1),e.scheduleOnce(function(){e.rabbitSpine.setAnimation(0,"idle",!0)},3.5))}).union().repeatForever().start()},t.prototype.setUI=function(e,t){this._spinBtn=e,this._stopBtn=t},t.prototype.initRowItem=function(){this._itemRows.length=0,this._content.destroyAllChildren();for(var e=p.default.ConverSlotTables(f.default.getSlotGameData().tables,4,3),t=0;t<3;t++){var i=cc.instantiate(this.row);i.name=t+"",i.parent=this._content,i.x=215*t-215;var n=i.getComponent(g.default);this._itemRows.push(n),n.init(e.elementIndexs[t],t)}this._rollingStatus=l.default.Status_NoAction},t.prototype.onEventFreeGame=function(e){if(this.bFree=e,this.bFree){this.lastSpinSecs=-100,this._contentFree.destroyAllChildren();for(var t=0;t<3;t++)this._content.getChildByName(""+t)&&(this._content.getChildByName(""+t).parent=this._contentFree);this.resetSpinData()}else this.rabbitSpine.node.active=!0,this.rabbitSpine.setAnimation(0,"idle",!0)},t.prototype.onEventMoneyFall=function(){var e=this;this._freeNode.active=!0,this.itemFallAnim(),this._freeSpine2.active=!0;for(var t=0;t<11;t++)cc.tween(this._freeSpine2).delay(.3*t).call(function(){var t=e.createElemItem(10+Math.floor(10*Math.random()),e._freeSpine2);e.setItemPos(t,1),t.setScale(0);var i=-1;Math.random()<.25?i=0:Math.random()<.6&&(i=1),cc.tween(t).by(.05,{scale:1}).delay(.05).by(.3,{scale:.3,position:cc.v3(170*i,-100)}).by(.2,{position:cc.v3(45*i,-150)}).by(.25,{position:cc.v3(0,-300),scale:-.3}).call(function(){t.removeFromParent()}).start()}).start();this.scheduleOnce(function(){for(var t=0;t<5;t++)for(var i=function(i){var n=e.createElemItem(9,e._contentFree);n.getComponent(S.default).setFreeNullBg();var o=-436,a=424;1==i?n.setPosition(215*i-214,424-172*t):(n.setPosition(215*i-214,340-172*t),o=-520,a=340);var l=.1*(5-t);cc.tween(n).to(l,{position:cc.v3(215*i-214,o)}).call(function(){n.setPosition(215*i-214,a),cc.tween(n).to(.4,{position:cc.v3(215*i-214,o)}).call(function(){n.setPosition(215*i-214,a)}).union().repeat(2).call(function(){n.removeFromParent()}).start()}).start()},n=0;n<3;n++)i(n)},3.2),this.scheduleOnce(function(){e._freeSpine2.destroyAllChildren(),e._contentFree.destroyAllChildren(),d.GlobalEvent.emit("RabbitFreeStart")},4)},t.prototype.itemFallAnim=function(){for(var e=0;e<5;e++)for(var t=function(t){var n=i.createElemItem(Math.floor(7*Math.random())+1,i._contentFree),o=-264,a=424;1==t?n.setPosition(215*t-214,424-172*e):(n.setPosition(215*t-214,340-172*e),o=-348,a=340);var l=(5+e)/10;cc.tween(n).to(l,{position:cc.v3(215*t-214,o)}).call(function(){n.setPosition(215*t-214,a),cc.tween(n).to(.4,{position:cc.v3(215*t-214,o)}).call(function(){n.setPosition(215*t-214,a)}).union().repeat(6).call(function(){n.removeFromParent()}).start()}).start()},i=this,n=0;n<3;n++)t(n)},t.prototype.showWinLineNum=function(e,t){void 0===t&&(t=0);var i=this._nodeLine.getChildByName("nodeLineNum"),n=i.getChildByName("labelLeft"+e);n.getChildByName("select").active=!0,n.getChildByName("line").active=!0;var o=i.getChildByName("labelRight"+e);o.getChildByName("select").active=!0,10==e&&(n.getChildByName("labelLeft0").getChildByName("select").active=!0,o.getChildByName("labelRight0").getChildByName("select").active=!0),0!=t&&(this.labelLineScore.string=t.toFixed(2),1==e?this.labelLineScore.node.position=cc.v3(0,555):2==e||3==e||4==e||5==e?this.labelLineScore.node.position=cc.v3(0,385):6==e||7==e||8==e||9==e?this.labelLineScore.node.position=cc.v3(0,215):10==e&&(this.labelLineScore.node.position=cc.v3(0,45)))},t.prototype.hideAllLineNum=function(){for(var e=this._nodeLine.getChildByName("nodeLineNum"),t=0;t<e.children.length;t++)e.children[t].getChildByName("select").active=!1;for(e.getChildByName("labelLeft10").getChildByName("labelLeft0").getChildByName("select").active=!1,e.getChildByName("labelRight10").getChildByName("labelRight0").getChildByName("select").active=!1,t=0;t<10;t++)e.children[t].getChildByName("line").active=!1;this.labelLineScore.string=""},t.prototype.onSpin=function(e){var t=this;if(this._rollingStatus==l.default.Status_NoAction){this._scrollAudioId=b.default.playEffectByClip(this.elemtScroll);var i=C.snData.game.levelId;console.warn("xxxxspin levelid:",i),m.SlotNetWorkReq.SpinSlotReq(f.default.getSlotThemeid(),i,e||this._betValue,!!e),this.resetSpinData(),this._spinBtn.interactable=!1,this._rollingStatus=l.default.Status_RollAction;for(var n=0;n<3;n++)d.GlobalEvent.emit(s.default.RollState_Start,n);e||(u.default.sendAFEvent(h.AnalyticsAFCfg.EVENT_AF_SPIN),u.default.sendAFEvent(h.AnalyticsAFCfg.EVENT_AF_BET_PRICE,"","af_price",parseFloat(v.default.divide(this._betValue,1e4)))),this.scheduleOnce(function(){t._spinBtn.node.active=!1,t._stopBtn.node.active=t._stopBtn.interactable=t._spinBtn.interactable=!0;var e=t._stopBtn.node.getChildByName("Background").getComponent(sp.Skeleton);e.setAnimation(0,"dianji",!1),t.scheduleOnce(function(){e.setAnimation(0,"xuanzhuan",!0)},.5),t._contentLight.active=!0,t._contentLight.getComponent(sp.Skeleton).setAnimation(0,"animation",!1)},.05)}},t.prototype.resetSpinData=function(){if(this._freeNode.active&&!this.bFree){d.GlobalEvent.emit(s.default.Start_FreeSpin,!1),this._freeNode.active=!1;for(var e=0;e<3;e++)this._contentFree.getChildByName(""+e)&&(this._contentFree.getChildByName(""+e).parent=this._content)}cc.Tween.stopAllByTarget(this._nodeWinBgParent),this._nodeWinBgParent.destroyAllChildren(),this._nodeWinItemParent.destroyAllChildren(),this._nodeWinMask.active=!1,this.hideAllLineNum()},t.prototype.onStop=function(){if(this._rollingStatus==l.default.Status_StartAction){this._rollingStatus=l.default.Status_RollAction,this._stopBtn.interactable=!1;for(var e=0;e<3;e++)0==this._itemRows[e].startStop&&(cc.Tween.stopAllByTarget(this._itemRows[e].node),d.GlobalEvent.emit(s.default.RollState_Stop,e))}},t.prototype.SpinSlotRsp=function(e){var t=this;if(console.log("@@@@@@@@@@@ data: ",JSON.stringify(e)),this._completeCount=0,0==e.result.err_code)if(u.default.sendAFEvent(h.AnalyticsAFCfg.EVENT_AF_START_GAME),u.default.sendH5Event(h.AnalyticsH5Event.Start_game),this.bFree||(this.lastSpinSecs=0),this._resultInfo=e,this.curMoneyIdAry=[],this.curMoneyPosAry=[],this._resultInfo.is_rabbit_mode)this.rabbitSpine.setAnimation(0,"tease_idle",!1),b.default.playEffectByClip(this.rabbitReadyClip),this._freeMoneyTanZhaoDeng.active=!0,this._freeMoneyTanZhaoDeng.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.scheduleOnce(function(){t.spinEndState(),t.rabbitSpine.setAnimation(0,"freespin",!1)},1.5);else{if(-1!==this._resultInfo.tables.indexOf(8)){for(var i=0;i<this._resultInfo.tables.length;i++)8==this._resultInfo.tables[i]&&this.curMoneyPosAry.push(i);var n=[],o=[.5,1,2,5,10,20,30,50,100,500];for(i=0;i<this._resultInfo.rabbit_bet_multis.length;i++)for(var a=0;a<o.length;a++)this._resultInfo.rabbit_bet_multis[i]/100==o[a]&&(n.push(10+a),this.curMoneyIdAry.push(10+a));this._resultInfo.tables=this._resultInfo.tables.map(function(e){return 8==e?n.shift():e})}this.showResult()}else y.default.setTip(e.result.err_desc),this.scheduleOnce(function(){for(var e=0;e<3;e++)0==t._itemRows[e].startStop&&(cc.Tween.stopAllByTarget(t._itemRows[e].node),d.GlobalEvent.emit(s.default.RollState_Stop,e));b.default.playEffectByClip(t.scrollEndClip)},.3)},t.prototype.showResult=function(){for(var e=this,t=p.default.ConverSlotTables(this._resultInfo.tables,4,3),i=0;i<3;i++)d.GlobalEvent.emit(s.default.GetServerData,i,t.elementIndexs[i],t.serverIndexs[i]);var n=0;if(this._resultInfo.is_free)this.scheduleOnce(function(){for(var e=0;e<5;e++)d.GlobalEvent.emit(s.default.RollState_Stop,e)},.7),this.scheduleOnce(function(){e._rollingStatus=l.default.Status_StartAction,e.checkfirstStop()},.5);else{var o=0,a=function(t){var i=e._itemRows[t].delayTime;c.SlotGameCfg.isFirstStop&&(i=e._itemRows[t].delayTime/3),cc.tween(e._itemRows[t].node).delay(i).call(function(){var i=0;d.GlobalEvent.emit(s.default.RollState_Stop,t);for(var r=0;r<=n;r++)i+=e._itemRows[r].scatterNum;if(i&&o<i&&b.default.playEffectByClip(e.wildAppearClip),o<i&&(o=i),++n<3)a(n);else{var p=.5;c.SlotGameCfg.isFirstStop&&(p=.1),e.scheduleOnce(function(){e._rollingStatus=l.default.Status_StartAction,e.checkfirstStop()},p)}}).start()};a(n)}},t.prototype.onRollComplete=function(){var e=this;if(this._completeCount++,b.default.playEffectByClip(this.scrollEndClip),3==this._completeCount){var t=.2;if(this._luckyPos.length=0,this._resultInfo){if(this._resultInfo.win_line.length>0)for(var i=0;i<this._resultInfo.win_line.length;i++)for(var n=this._resultInfo.win_line[i].lucky_pos,o=0;o<n.length;o++)-1==this._luckyPos.indexOf(n[o])&&this._luckyPos.push(n[o]);if(this.bFree){if(this.curMoneyIdAry.length>=5){var a=function(t){d.GlobalEvent.emit(s.default.PlayLuckyElementAnimate,l.curMoneyPosAry[t]);var i=cc.instantiate(l.pfFreeMoney);i.parent=l.node.parent;var n=l._resultInfo.rabbit_bet_multis[t]/100*f.default.curBetNum;n/1e4>=5?i.getChildByName("label2").getComponent(cc.Label).string=n/1e4+"":i.getChildByName("label1").getComponent(cc.Label).string=n/1e4+"",l.setItemPos(i,l.curMoneyPosAry[t],!0),i.position=cc.v3(i.position.x-2,i.position.y),d.GlobalEvent.emit("RabbitHideFreeMoney",l.curMoneyPosAry[t]),cc.tween(i).delay(.5+.2*t).to(.5,{position:cc.v3(0,-349)}).call(function(){d.GlobalEvent.emit("RabbitPlayFreeMoneySpine"),b.default.playEffectByClip(e.freeMoneyClipAry[t]),i.removeFromParent()}).start(),l.scheduleOnce(function(){d.GlobalEvent.emit("RabbitGetFreeMoney",e.curMoneyPosAry[t])},.5+.2*t)},l=this;for(o=0;o<this.curMoneyIdAry.length;o++)a(o);t+=.5+.2*this.curMoneyIdAry.length}}else if(this.showMoneyAnim(),this.curMoneyIdAry.length>=5)for(o=0;o<this.curMoneyIdAry.length;o++){var r=this.createElemItem(this.curMoneyIdAry[o],this._nodeWinItemParent);this.setItemPos(r,this.curMoneyPosAry[o]),r.getComponent(S.default).playAnimate()}}cc.tween(this.node).delay(.1).call(function(){cc.audioEngine.stopEffect(e._scrollAudioId),e._resultInfo&&e._luckyPos.length&&!e.bFree&&(1==e._resultInfo.win_type?e.rabbitSpine.setAnimation(0,"win",!1):2==e._resultInfo.win_type?e.rabbitSpine.setAnimation(0,"win2",!1):e._resultInfo.win_type>2&&e.rabbitSpine.setAnimation(0,"win3",!1),e.scheduleOnce(function(){e.rabbitSpine.setAnimation(0,"idle",!0)},1),e.showNormalWin())}).delay(t).call(function(){e.spinEndState(),e._luckyPos.length&&(e._spinBtn.interactable=!1,e._spinBtn.node.getChildByName("Background").active=!1,e._spinBtn.node.getChildByName("spin2").active=!0,e.scheduleOnce(function(){e._spinBtn.interactable=!0,e._spinBtn.node.getChildByName("Background").active=!0,e._spinBtn.node.getChildByName("spin2").active=!1},1))}).start()}},t.prototype.spinEndState=function(){this._spinBtn.node.active=this._spinBtn.interactable=!0,this._stopBtn.node.active=!1,this._resultInfo&&d.GlobalEvent.emit(s.default.OpenWinAward),this._rollingStatus=l.default.Status_NoAction},t.prototype.showMoneyAnim=function(){for(var e=this,t=[],i=0;i<this._resultInfo.tables.length;i++)8==this._resultInfo.tables[i]&&t.push(i);t.length&&this.scheduleOnce(function(){for(var i=function(i){var n=cc.instantiate(e.pfMoneyParticle);n.parent=e._nodeWinItemParent,n.setScale(2),e.setItemPos(n,t[i]);var o=cc.instantiate(e.pfMoneySpineLight);o.parent=e._nodeWinItemParent,o.setPosition(n.position.x,n.position.y+20),o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.removeFromParent()}),b.default.playEffectByClip(e.moneyAppearClip),cc.tween(n).to(.1,{scale:2}).to(0,{scale:1}).bezierTo(.3,cc.v2(n.getPosition().x-200,n.getPosition().y),cc.v2(-200,400),cc.v2(-195,475)).call(function(){n.removeFromParent(),e.rabbitSpine.setAnimation(0,"vfx_collect_fx1",!1),e.rabbitSpine.setCompleteListener(function(){e.rabbitSpine.setAnimation(0,"idle",!0)})}).start()},n=0;n<t.length;n++)i(n)},.2)},t.prototype.createElemItem=function(e,t){var i=cc.instantiate(this.pfElemItem);return t.addChild(i),i.getComponent(S.default).init(),i.getComponent(S.default).setCurrNode(e-1),i},t.prototype.setItemPos=function(e,t,i){void 0===i&&(i=!1);var n=172,o=0;i&&(n=165,o=20),t%3==1?e.setPosition(t%3*215-214,252-Math.floor(t/3)*n+o):e.setPosition(t%3*215-214,168-Math.floor(t/3)*n+o)},t.prototype.showNormalWin=function(){this._nodeWinMask.active=!0;for(var e=[],t=0;t<this._luckyPos.length;t++){var i=cc.instantiate(this.pfWinAnimBg);i.parent=this._nodeWinBgParent,i.name=this._luckyPos[t]+1+"",this.setItemPos(i,this._luckyPos[t]),e.push(i),i.active=!1}var n=[];for(t=0;t<this._luckyPos.length;t++){var o=this.createElemItem(this._resultInfo.tables[this._luckyPos[t]],this._nodeWinItemParent);this.setItemPos(o,this._luckyPos[t]),o.getComponent(S.default).playAnimate(),n.push(o),o.active=!1}var a=[],l=[],r=f.default.getSlotGameData().tax_rate;console.warn("xxxxxxxxxxxxxx=======:",r);for(var s=(100-r)/100,c=0;c<this._resultInfo.win_line.length;c++)a.push(this._resultInfo.win_line[c].lineId+1),l.push(Number(this._resultInfo.win_line[c].win_coin)*s/1e4);this.playWinAnim(this._nodeWinBgParent,e,n,a,l)},t.prototype.playWinAnim=function(e,t,i,n,o){var a=this;cc.tween(e).call(function(){for(var e=0;e<n.length;e++)1==n.length?a.showWinLineNum(n[e],o[e]):a.showWinLineNum(n[e]);for(e=0;e<t.length;e++)t[e].active=!0,t[e].getChildByName("winAnim").getComponent(sp.Skeleton).setAnimation(0,"animation",!1),i[e].active=!0;for(e=0;e<a._luckyPos.length;e++)d.GlobalEvent.emit("RabbitHideWinItem",a._luckyPos[e])}).delay(1.5).call(function(){a.hideAllLineNum();for(var l=0;l<t.length;l++)t[l].active=!1,i[l].active=!1;for(l=0;l<a._luckyPos.length;l++)d.GlobalEvent.emit("RabbitShowWinItem",a._luckyPos[l]);var r=function(l){cc.tween(e).call(function(){a.showWinLineNum(n[l],o[l]);for(var e=0;e<t.length;e++)for(var r=0;r<B.length;r++)if(n[l]==B[r].lineId)for(var s=0;s<B[r].serverPos.length;s++)Number(t[e].name)==B[r].serverPos[s]&&(t[e].active=!0,t[e].getChildByName("winAnim").getComponent(sp.Skeleton).setAnimation(0,"animation",!1),i[e].active=!0,d.GlobalEvent.emit("RabbitHideWinItem",Number(t[e].name)-1))}).delay(1.5).call(function(){a.hideAllLineNum();for(var e=0;e<t.length;e++)t[e].active=!1,i[e].active=!1;for(e=0;e<a._luckyPos.length;e++)d.GlobalEvent.emit("RabbitShowWinItem",a._luckyPos[e])}).delay(.3).call(function(){++l<n.length&&r(l)}).start()};r(0)}).delay(1.8*n.length+.1).union().repeatForever().start()},t.prototype.onUpdateBetValue=function(e){this._betValue=e},t.prototype.onSpinTest=function(){},t.prototype.onDestroy=function(){this._spinBtn=this._stopBtn=null,cc.audioEngine.stopEffect(this._scrollAudioId),e.prototype.onDestroy.call(this)},a([A(cc.Prefab)],t.prototype,"row",void 0),a([A(cc.AudioClip)],t.prototype,"elemtScroll",void 0),a([A(cc.AudioClip)],t.prototype,"scrollEndClip",void 0),a([A(cc.AudioClip)],t.prototype,"bgmRabbitClip",void 0),a([A(cc.AudioClip)],t.prototype,"moneyAppearClip",void 0),a([A(cc.AudioClip)],t.prototype,"wildAppearClip",void 0),a([A([cc.AudioClip])],t.prototype,"freeMoneyClipAry",void 0),a([A(cc.AudioClip)],t.prototype,"rabbitReadyClip",void 0),a([A(cc.Prefab)],t.prototype,"pfLineNum",void 0),a([A(cc.Prefab)],t.prototype,"pfWinAnimBg",void 0),a([A(cc.Prefab)],t.prototype,"pfElemItem",void 0),a([A(cc.Label)],t.prototype,"labelLineScore",void 0),a([A(cc.Prefab)],t.prototype,"pfMoneyParticle",void 0),a([A(cc.Prefab)],t.prototype,"pfMoneySpineLight",void 0),a([A(cc.Prefab)],t.prototype,"pfFreeMoney",void 0),a([w],t)}(r.SlotBaseContentCom);i.default=I,cc._RF.pop()},{"../../Script/BaseSlot/RollState":void 0,"../../Script/BaseSlot/SlotBaseContentCom":void 0,"../../Script/BaseSlot/SlotEvent":void 0,"../../Script/BaseSlot/SlotGameCfg":void 0,"../../Script/BaseSlot/SlotTool":void 0,"../../Script/Core/Analytics/AnalyticsCfg":void 0,"../../Script/Core/Analytics/AnalyticsMgr":void 0,"../../Script/Core/Event/GlobalEvent":void 0,"../../Script/Core/Module/GameData":void 0,"../../Script/Core/Net/SlotNetWorkReq":void 0,"../../Script/Core/Net/SocketMgr":void 0,"../../Script/Core/Tool/CommonFun":void 0,"../../Script/Core/Tool/MathTool":void 0,"../../Script/Core/Tool/SoundMgr":void 0,"../../Script/app/data":void 0,"./RabbitSlotsItemCom":"RabbitSlotsItemCom","./RabbitSlotsRowCom":"RabbitSlotsRowCom"}],RabbitSlotsItemCom:[function(e,t,i){"use strict";cc._RF.push(t,"dffafOAV4BIC4m5sYN6hntJ","RabbitSlotsItemCom");var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,l=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(a<3?o(l):a>3?o(t,i,l):o(t,i))||l);return a>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("../../Script/BaseSlot/SlotEvent"),r=e("../../Script/Core/Event/GlobalEvent"),s=e("../../Script/Core/Module/GameData"),c=cc._decorator,p=c.ccclass,h=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementNode=[],t._currId=-1,t.elementSpine=[],t._isFreeSpin=!1,t}return o(t,e),t.prototype.onLoad=function(){r.GlobalEvent.on(l.default.Start_FreeSpin,this.onEventFreeSpin,this)},t.prototype.onDestroy=function(){r.GlobalEvent.off(l.default.Start_FreeSpin,this.onEventFreeSpin,this)},t.prototype.onEventFreeSpin=function(e){this._isFreeSpin=e,this._isFreeSpin?this.elementNode[8].getChildByName("freeBg").active=!0:this.elementNode[8].getChildByName("freeBg").active=!1},t.prototype.setFreeNullBg=function(){this.elementNode[8].getChildByName("freeBg").active=!0},t.prototype.init=function(){for(var e=0;e<this.elementNode.length;e++)this.elementNode[e].item=this.elementNode[e].getChildByName("item"),this.elementSpine[e]=this.elementNode[e].getChildByName("skeleton").getComponent(sp.Skeleton)},t.prototype.reset=function(){var e=this;-1!=this._currId&&(this.scheduleOnce(function(){e.elementNode[9].opacity=255,e.elementNode[9].getChildByName("label1").getComponent(cc.Label).string="",e.elementNode[9].getChildByName("label2").getComponent(cc.Label).string=""},.3),this.elementNode[this._currId].item.active=!0,this.elementSpine[this._currId]&&(this.elementSpine[this._currId].node.active=!1))},t.prototype.setCurrNode=function(e){this._isFreeSpin&&e<7&&(e=Math.random()<.5?8:Math.floor(10*Math.random())+9),e>8&&(this.setMoneyShow([.5,1,2,5,10,20,30,50,100,500][e-9]),e=9),-1!=this._currId&&(this.elementNode[this._currId].active=!1),this.elementNode[e].active=!0,this.elementNode[e].item.active=!0,this._currId=e},t.prototype.setMoneyShow=function(e){void 0===e&&(e=0),this.elementNode[9].getChildByName("label1").getComponent(cc.Label).string="",this.elementNode[9].getChildByName("label2").getComponent(cc.Label).string="",(e*=s.default.curBetNum)/1e4>=5?this.elementNode[9].getChildByName("label2").getComponent(cc.Label).string=e/1e4+"":this.elementNode[9].getChildByName("label1").getComponent(cc.Label).string=e/1e4+""},t.prototype.hideFreeMoney=function(){this.elementNode[9].getChildByName("label2").opacity=0,this.elementNode[9].getChildByName("label1").opacity=0},t.prototype.getFreeMoney=function(){this.elementNode[9].opacity=155,this.elementNode[9].getChildByName("label2").opacity=255,this.elementNode[9].getChildByName("label1").opacity=255},t.prototype.playAnimate=function(){-1!=this._currId&&(this.elementNode[this._currId].item.active=!1,null!=this.elementSpine[this._currId]&&(this.elementSpine[this._currId].node.active=!0,9==this._currId&&this.elementSpine[this._currId].setAnimation(0,"animation",!1)))},t.prototype.hideSelf=function(){-1!=this._currId&&(this.elementNode[this._currId].item.active=!1)},t.prototype.showSelf=function(){-1!=this._currId&&(this.elementNode[this._currId].item.active=!0)},a([h(cc.Node)],t.prototype,"elementNode",void 0),a([p],t)}(cc.Component);i.default=u,cc._RF.pop()},{"../../Script/BaseSlot/SlotEvent":void 0,"../../Script/Core/Event/GlobalEvent":void 0,"../../Script/Core/Module/GameData":void 0}],RabbitSlotsRowCom:[function(e,t,i){"use strict";cc._RF.push(t,"5da05DKJM1JO6Cs421Tq+O4","RabbitSlotsRowCom");var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,l=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(a<3?o(l):a>3?o(t,i,l):o(t,i))||l);return a>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("../../Script/BaseSlot/SlotRowBase"),r=e("../../Script/Core/Event/GlobalEvent"),s=e("../../Script/Core/Tool/CommonTool"),c=e("./RabbitSlotsItemCom"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._speed=570,t._winAnimateNode=null,t._minigameId=7,t}return o(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._startY=-537,this._spaceY=177,this._elementCount=8,r.GlobalEvent.on("RabbitGetFreeMoney",this.onGetFreeMoney,this),r.GlobalEvent.on("RabbitHideFreeMoney",this.onHideFreeMoney,this),r.GlobalEvent.on("RabbitHideWinItem",this.onHideWinItem,this),r.GlobalEvent.on("RabbitShowWinItem",this.onShowWinItem,this)},t.prototype.init=function(e,t){e.push(1),e.unshift(Math.floor(8*Math.random())+1);for(var i=0;i<5;i++){var n=cc.instantiate(this.item);n.parent=this.node,n.y=this._startY+this._spaceY*i,1==t&&(n.y+=88),n.name=i+"",this._itemList.unshift(n),this._itemQueueTag.push(String(i)),n.RabbitSlotsItemCom=n.getComponent(c.default),n.RabbitSlotsItemCom.init(),n.RabbitSlotsItemCom.reset(),e[i]?8==e[i]&&(e[i]=Math.floor(7*Math.random())+1):e[i]=1,n.RabbitSlotsItemCom.setCurrNode(e[i]-1)}var o=this._itemList[this._itemList.length-1];this._endReelY=s.default.ConverNodePos(o,this.node.parent).y+8,1!=t&&(this._endReelY+=this._spaceY),this._rowId=t;var a=this._itemList.length;this._itemList[a-1].y-=200,this._orgDelayTime=.25,this._orgDelayTime=0==this._rowId?this._orgDelayTime+.4:this._orgDelayTime,this._delayTime=this._orgDelayTime,this.scatterNum=0,this.minigameNum=0},t.prototype.updateItemPosition=function(){var e=this._itemQueueTag[0];if(e!==this._stopTag){var t=this.node.getChildByName(String(e));if(t){var i=null;if(s.default.ConverNodePos(t,this.node.parent).y<this._endReelY){this._itemQueueTag.shift(),i=t;var n=this._itemQueueTag[this._itemQueueTag.length-1],o=this.node.getChildByName(String(n));t.y=o.y+this._spaceY-3,t.zIndex=o.zIndex-1<0?0:o.zIndex-1,this._itemQueueTag.push(String(e))}if(i){var a=this._elemSequen?this.getElemtId():Math.floor(Math.random()*this._elementCount)+1;this.startStop&&(i.serverpos=this._serverPos.shift(),a=this._resultQueue.shift()||a,this._canStartStop||0!=this._resultQueue.length||(this._canStartStop=!0,this._stopTag=parseInt(i.name))),7==(a-=1)&&(a=9+Math.floor(10*Math.random())),i.RabbitSlotsItemCom.setCurrNode(a),i.zIndex=a}}this.checkStartStopAction()}},t.prototype.resetdata=function(){e.prototype.resetdata.call(this);for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].RabbitSlotsItemCom.reset()},t.prototype.onPlayLuckElement=function(e){for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].serverpos==e&&this._itemList[t].RabbitSlotsItemCom.playAnimate()},t.prototype.onGetFreeMoney=function(e){for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].serverpos==e&&this._itemList[t].RabbitSlotsItemCom.getFreeMoney()},t.prototype.onHideFreeMoney=function(e){for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].serverpos==e&&this._itemList[t].RabbitSlotsItemCom.hideFreeMoney()},t.prototype.onHideWinItem=function(e){for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].serverpos==e&&this._itemList[t].RabbitSlotsItemCom.hideSelf()},t.prototype.onShowWinItem=function(e){for(var t=this._itemList.length-1;t>=0;t--)this._itemList[t].serverpos==e&&this._itemList[t].RabbitSlotsItemCom.showSelf()},t.prototype.getElemtId=function(){var e=this._elemSequen.shift();return this._elemSequen.push(e),e},a([h],t)}(l.default));i.default=u,cc._RF.pop()},{"../../Script/BaseSlot/SlotRowBase":void 0,"../../Script/Core/Event/GlobalEvent":void 0,"../../Script/Core/Tool/CommonTool":void 0,"./RabbitSlotsItemCom":"RabbitSlotsItemCom"}],RabbitSlotsScene:[function(e,t,i){"use strict";cc._RF.push(t,"c36f2HIFnNKZYz15fjMr0Qc","RabbitSlotsScene");var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,l=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(a<3?o(l):a>3?o(t,i,l):o(t,i))||l);return a>3&&l&&Object.defineProperty(t,i,l),l},l=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function l(e){try{s(n.next(e))}catch(t){a(t)}}function r(e){try{s(n.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(l,r)}s((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var i,n,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(a){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,n=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(r){a=[6,r],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=e("../../Script/BaseSlot/SlotBaseScene"),c=e("../../Script/BaseSlot/SlotEvent"),p=e("../../Script/Common/ChooseOneSprite"),h=e("../../Script/Core/Analytics/AnalyticsCfg"),u=e("../../Script/Core/Analytics/AnalyticsMgr"),d=e("../../Script/Core/Common/TipsPopup"),f=e("../../Script/Core/Config/LanguageCfg"),m=e("../../Script/Core/Event/GlobalEvent"),_=e("../../Script/Core/Module/GameData"),y=e("../../Script/Core/Net/SocketMgr"),v=e("../../Script/Core/Scene/SceneMgr"),b=e("../../Script/Core/Tool/CommonFun"),C=e("../../Script/Core/Tool/CommonTool"),S=e("../../Script/Core/Tool/GetComByName"),g=e("../../Script/Core/Tool/MathTool"),N=e("../../Script/Core/Tool/SoundMgr"),w=e("../../Script/app/config"),A=e("../../Script/app/creator"),B=e("../../Script/app/logd"),I=e("../../Script/app/sn-res"),R=e("./RabbitSlotsContentCom"),E=cc._decorator,P=E.ccclass,F=E.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnSpinClip=null,t.normalwinClipAry=[],t.bigwin_sound_wClip=null,t.megawin_sound_mClip=null,t.superwin_sound_mClip=null,t.frspStartClip=null,t.frspEndClip=null,t.frspBgmClip=null,t.rabbitStartClip=null,t.rabbitReadyClip=null,t.nodeTips=null,t.curIndex=0,t.aryTipsInfo=[{width:460,delay:1},{width:964,delay:0},{width:340,delay:1},{width:244,delay:1}],t._lastBetNum=0,t._effectAudioId=-1,t.totalFreeWin=0,t.nLastRabbitRound=0,t.canShowFakeRabbit=!1,t}return o(t,e),t.prototype.initEvent=function(){w.config.applicaion.isVScreenGame=!0,cc.view.setDesignResolutionSize(720,1520,cc.ResolutionPolicy.SHOW_ALL),C.default.changeOrientation(0),e.prototype.initEvent.call(this),y.default.init(this,["SpinSlotRsp","LeaveSlotThemeRsp"],["SpinSlotRsp"]),this.repeatPlayTips(),m.GlobalEvent.on("change_normal_bgm",this.changeNormalBgm,this),m.GlobalEvent.on("RabbitFreeStart",this.onCloseFreeAnimate,this),m.GlobalEvent.on("RabbitPlayFreeMoneySpine",this.onPlayFreeMoneySpine,this)},t.prototype.onPlayFreeMoneySpine=function(){this._nodeWin.active=!0,this._nodeWin.getChildByName("bigWin").active=!0,this._nodeWin.getChildByName("light").getComponent(sp.Skeleton).setAnimation(0,"animation",!1)},t.prototype.repeatPlayTips=function(){var e=this;this.curIndex=Math.floor(Math.random()*this.aryTipsInfo.length);for(var t=0,i=0;i<this.aryTipsInfo.length;i++)t+=this.aryTipsInfo[i].delay+this.aryTipsInfo[i].width/60;cc.tween(this.node).call(function(){e.playTipsAnimSeq()}).delay(t+1).union().repeatForever().start()},t.prototype.playTipsAnimSeq=function(){return l(this,void 0,Promise,function(){var e=this;return r(this,function(){return this.playTipsAnim(this.curIndex).then(function(t){e.playTipsAnim(t).then(function(t){e.playTipsAnim(t).then(function(t){e.playTipsAnim(t)})})}),[2]})})},t.prototype.playTipsAnim=function(e){return l(this,void 0,Promise,function(){var t=this;return r(this,function(){return[2,new Promise(function(i){t.nodeTips.getComponent(p.default).init(e);var n=cc.v3(5,0),o=cc.v3(-300-t.aryTipsInfo[e].width,0);t.aryTipsInfo[e].delay||(n=cc.v3(5+t.aryTipsInfo[e].width/2,0),o=cc.v3(-300-t.aryTipsInfo[e].width/2,0)),cc.tween(t.nodeTips).to(0,{position:n}).delay(t.aryTipsInfo[e].delay).to(t.aryTipsInfo[e].width/60,{position:o}).call(function(){t.nodeTips.setPosition(720+t.aryTipsInfo[e].width/2,0),i(++e%t.aryTipsInfo.length)}).start()})]})})},t.prototype.initUiData=function(){var t=this;if(e.prototype.initUiData.call(this),this._slotContentNode.getComponent(R.default).setUI(this._spinBtn.button,this._stopBtn.button,this._autoBtn.button),_.default.getSlotGameData().free_count>0){this._freeCount=_.default.getSlotGameData().free_count;var i={tipsInfo:f.default.Formate("You have X rough free",this._freeCount),yesCallBack:function(){t.scheduleOnce(function(){m.GlobalEvent.emit("RabbitFreeGame",!0),m.GlobalEvent.emit(c.default.Start_FreeSpin,!0),t._nodeBottom.active=!1,t._nodeRabbit.active=!1,t.startFreeSpin()},.3)},isNo:!1,bHelper:!0};d.TipsPopupHelper.show(i)}},t.prototype.onUpdatUI=function(){e.prototype.onUpdatUI.call(this),this._stopBtn.active=!1,this._spinBtn.active=!0,this._spinBtn.button.interactable=this._autoBtn.button.interactable=!0},t.prototype.SpinSlotRsp=function(e){var t=this;if(this._freeNode.active||(this._nodeWin.active=!1),0==e.result.err_code){this.round++;var i;i=e.is_free?Number(e.win_coins):Number(e.win_coins)-Number(e.bet_coins),u.default.sendAFEvent(h.AnalyticsAFCfg.getEventPlayGame(),{round:this.round,goldChange:g.default.divide(i,1e4)}),this._lastBetNum=Number(e.bet_coins),_.default.curBetNum=this._lastBetNum,this._serverGold=e.now_coin,this._resultData=e,this._winGold=e.win_coins,this._isMiniGame=!1,this._isFreeSpin=!1,e.is_free?(this._freeCount>0&&this._freeCount--,e.win_free.free_count?(this._isFreeSpin=!0,this._freeCurrCount=Number(e.win_free.free_count)-this._freeCount,this._freeCount=Number(e.win_free.free_count)):this._freenumlabel.label.string=this._freeCount+"",this._freeCount<=0&&(this._freenumlabel.label.string="",this._lastFree.active=!1,this._freeOver.active=!0),this._freeTotalWinNum+=Number(e.win_coins)):(this._freeCount=this._freeCurrCount=Number(e.win_free.free_count),this._myGold=g.default.sub(this._myGold,g.default.divide(Number(e.bet_coins),1e4)),this._isFreeSpin=!!e.win_free.free_count,this._freeTotalWinNum=0,this._autoNum>0&&(this._autoNum--,this._autonumlabel.label.string=this._autoNum+""),this._winNumLabel.label.string="0"),this._resultData.win_minigame&&this._resultData.win_minigame.count>=1&&(this._resultData.win_minigame.count-=1,this._isMiniGame=!0),this._freeNode.active||(this._goldLabel.label.string=this._myGold),e.is_rabbit_mode?(this.nLastRabbitRound=0,this.canShowFakeRabbit=!0):e.is_free||(this.nLastRabbitRound++,this.canShowFakeRabbit&&this.nLastRabbitRound<4&&Math.random()<.2&&(this._freeMoneyTanZhaoDeng.active=!0,this._freeMoneyTanZhaoDeng.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this._nodeRabbit.getComponent(sp.Skeleton).setAnimation(0,"tease_idle",!1),N.default.playEffectByClip(this.rabbitReadyClip),cc.tween(this._ContentDownLayer).to(2,{scale:.92}).call(function(){t._freeMoneyTanZhaoDeng.active=!1,t._nodeRabbit.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}).to(1,{scale:1}).call(function(){t.canShowFakeRabbit=!1}).start()))}else b.default.setTip(e.result.err_desc)},t.prototype.LeaveSlotThemeRsp=function(){v.default.runScene("HallScene")},t.prototype.onHideAutoNode=function(){this._autoNode.active=!1},t.prototype.onOpenWinAward=function(){var t=this;if(e.prototype.onOpenWinAward.call(this),this._myGold=this._serverGold,this._freeNode.active)this.showCurAward(10);else{switch(this._resultData.win_type){case 1:return void this.createWinAnimate();case 2:return void this.createAnimateNode("bigWinNode");case 3:return void this.createAnimateNode("megaWinNode");case 4:return void this.createAnimateNode("superWinNode")}C.default.NumAnimate(this._goldLabel.label,.5,1e4*Number(this._goldLabel.label.string),1e4*Number(this._myGold),1,1,function(){t._goldLabel.label.string=t._myGold})}this.judgeFinish()},t.prototype.judgeFinish=function(){var e=this;return this._isFreeSpin?(this._isPlayAnimate=!0,void this.scheduleOnce(function(){e.playFreeSpinAnimate()},.5)):this._freeCount?void this.startFreeSpin(.5):(this.requestBrokeData(Number(this._myGold),this._lastBetNum),this._freeNode.active?(this._isPlayAnimate=!0,void this.scheduleOnce(function(){e.playFreeOverAnimate()},1)):(this._isPlayAnimate=!1,void this.startAutoSpin(.1)))},t.prototype.playFreeSpinAnimate=function(){return l(this,void 0,void 0,function(){var e,t=this;return r(this,function(i){switch(i.label){case 0:return N.default.playMusicByClip(this.frspBgmClip),this._effectAudioId=N.default.playEffectByClip(this.frspStartClip),[4,I.snRes.loadAsync("RabbitSlots","Prefabs/animateNode/freespinNode")];case 1:return(e=i.sent())?B.logd.warn("freespinNode","\u6210\u529f"):B.logd.warn("freespinNode","\u5931\u8d25"),this._freeSpinNode=this._freeSpinNode||cc.instantiate(e),null==this._freeSpinNode.parent&&(this._freeSpinNode.parent=this._ContentUpLayer),this._freeSpinNode.active=!0,this._freeSpinNode.opacity=255,this.totalFreeWin=0,this._freeMoneyAwardAnim.active=!1,this._freeMoneyTanZhaoDeng.active=!1,this._nodeBottom.active=!1,this._freeSpinNode.getChildByName("node").getChildByName("freeSpinAni").getComponent(sp.Skeleton).setAnimation(0,"animation",!1),N.default.playEffectByClip(this.rabbitStartClip),this.scheduleOnce(function(){t._freeNode.active=!0,t._lastFree.active=!0,t._freenumlabel.label.string="8",m.GlobalEvent.emit("RabbitFreeMoneyFall"),t._freeTitle.active=!0,cc.tween(t._freeSpinNode).to(1,{opacity:0}).start()},1.5),[2]}})})},t.prototype.playFreeOverAnimate=function(){return l(this,void 0,void 0,function(){var e,t=this;return r(this,function(i){switch(i.label){case 0:return this._effectAudioId=N.default.playEffectByClip(this.frspEndClip),[4,I.snRes.loadAsync("RabbitSlots","Prefabs/animateNode/freeOverNode")];case 1:return(e=i.sent())?B.logd.warn("freeOverNode","\u6210\u529f"):B.logd.warn("freeOverNode","\u5931\u8d25"),this._freeOverNode=this._freeOverNode||cc.instantiate(e),this._freeoverAni=this._freeoverAni||S.GetNodeByName(this._freeOverNode,"freeoverAni"),this._freeoverConten=this._freeoverConten||S.GetNodeByName(this._freeOverNode,"freeoverConten"),this._freewinLabel=this._freewinLabel||S.GetComByName(this._freeOverNode,"freewinLabel",cc.Label),this._freeCloseTimeLabel=this._freeCloseTimeLabel||S.GetComByName(this._freeOverNode,"freeCloseTimeLabel",cc.Label),null==this._freeOverNode.parent&&(this._freeOverNode.parent=this._ContentUpLayer,b.default.addClick(S.GetNodeByName(this._freeOverNode,"freeCloseBtn"),this.onCloseFreeOverAnimate.bind(this),this)),A.creator.setButtonIntervalTime(S.GetNodeByName(this._freeOverNode,"freeCloseBtn"),1e3),this._freeOverNode.active=!0,this._freewinLabel.string=g.default.divide(Number(this._freeTotalWinNum),1e4),this._freeoverConten.getChildByName("freeCloseBtn").active=!0,this.scheduleOnce(function(){if(t._freeoverConten.active=!0,!_.default.getRequestBigRewardStatue()){var e=t._countdown;t._freeCloseTimeLabel.string=e+"",t.schedule(function(){e>0?(e--,t._freeCloseTimeLabel.string=e+""):t.onCloseFreeOverAnimate()},1,t._countdown)}},.8),[2]}})})},t.prototype.onCloseFreeAnimate=function(){var e=this;N.default.playEffectByClip(this.btnTouchClip),cc.audioEngine.stopEffect(this._effectAudioId),m.GlobalEvent.emit("RabbitFreeGame",!0),m.GlobalEvent.emit(c.default.Start_FreeSpin,!0),this.unscheduleAllCallbacks();var t=this._freeSpinNode.getChildByName("node");t.__show=!0,this.startFreeSpin(),b.default.closeDialogAnimate(t,function(){e._freeSpinNode.active=e._isPlayAnimate=!1,t.scale=1})},t.prototype.onCloseFreeOverAnimate=function(){var e=this;cc.audioEngine.stopEffect(this._effectAudioId),this.unscheduleAllCallbacks();var t=this._freeOverNode.getChildByName("node");N.default.playEffectByClip(this.btnTouchClip),this.startAutoSpin(),t.__show=!0,m.GlobalEvent.emit("RabbitFreeGame",!1),this._nodeBottom.active=!0,b.default.closeDialogAnimate(t,function(){e._freeOverNode.active=e._freeoverConten.active=e._isPlayAnimate=!1,t.scale=1,e._autoBtn.button.interactable=!0,N.default.playMusicByClip(e.bmgClip)}),this._winNumLabel.label.string="0",this._nodeWin.active=!1,C.default.NumAnimate(this._goldLabel.label,.5,1e4*Number(this._goldLabel.label.string),1e4*Number(this._myGold),1,1,function(){e._goldLabel.label.string=e._myGold}),this._freeMoneyAwardAnim.active=!0,this._freeMoneyAwardAnim.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this._freeTitle.active=!1,this._lastFree.active=!1,this._freeOver.active=!1,cc.tween(this._ContentDownLayer).to(.5,{scale:1}).call(function(){e._frameTop.active=!1,e._frameLeft.active=!1,e._frameRight.active=!1}).start()},t.prototype.startFreeSpin=function(t){var i=this;e.prototype.startFreeSpin.call(this,t),this._freeCount>0?(this._freeNode.active||(cc.Tween.stopAllByTarget(this._winNumLabel.label.node),this._winNumLabel.label.string="0.00"),this._freeNode.active=!0,this._lastFree.active=!0,this._freeOver.active=!1,this.onHideAutoNode(),this._frameTop.active=!0,this._frameLeft.active=!0,this._frameRight.active=!0,cc.tween(this._ContentDownLayer).to(.5,{scale:.92}).start(),this._freeSpine.opacity=255,this.scheduleOnce(function(){i._freeSpine.opacity=80},2.5),t=t||.1,this.scheduleOnce(function(){i.onSpinCallBack()},t)):this.onCancelAutoCallBack()},t.prototype.winAnimateClose=function(e){var t=this;this.__winNodeAnimateNode.getChildByName("bg").getComponent(cc.BlockInputEvents)||this.__winNodeAnimateNode.getChildByName("bg").addComponent(cc.BlockInputEvents),this.unschedule(this.winAnimateClose);var i=this.__winNodeAnimateNode.getChildByName("node");i.__show=!0,b.default.closeDialogAnimate(i,function(){i.scale=1,t._isPlayAnimate=t.__winNodeAnimateNode.active=!1,1!=e&&t.judgeFinish()})},t.prototype.showCurAward=function(e){var t=this;if(void 0===e&&(e=1),10!=e||0!=Number(this._winGold)){this._nodeWin.active=!0,this._nodeWin.getChildByName("normalWin").active=!1,this._nodeWin.getChildByName("bigWin").active=!1,1==e?this._nodeWin.getChildByName("normalWin").active=!0:this._nodeWin.getChildByName("bigWin").active=!0;var i=this._nodeWin.getChildByName("layout").getChildByName("label").getComponent(cc.Label);if(10==e){var n=this.totalFreeWin;this.totalFreeWin+=Number(this._winGold),C.default.NumAnimate(i,.4,n,this.totalFreeWin,1,1,function(){i.string=g.default.divide(t.totalFreeWin,1e4)})}else this._nodeWin.scale=.8,i.string=g.default.divide(this._winGold,1e4),cc.tween(this._nodeWin).to(.1,{scale:1.1}).to(.1,{scaleX:.95,scaleY:1}).start()}},t.prototype.changeNormalBgm=function(){var e=this;this.scheduleOnce(function(){e.bmgClip&&N.default.playMusicByClip(e.bmgClip)},3)},t.prototype.createWinAnimate=function(){var e=this;this._isPlayAnimate=!0,this.scheduleOnce(function(){e.showCurAward(),N.default.playEffectByClip(e.normalwinClipAry[Math.floor(Math.random()*e.normalwinClipAry.length)]),e.scheduleOnce(e.judgeFinish,1),e._isPlayAward=!1,C.default.NumAnimate(e._goldLabel.label,.5,1e4*Number(e._goldLabel.label.string),1e4*Number(e._myGold),1,1,function(){e._goldLabel.label.string=e._myGold,b.default.showMoneyChangeWithDrawPopup(),e.requestBigRewardGiftData(),e.requestBrokeData(Number(e._myGold),e._lastBetNum),e._isPlayAward=!1});var t=1e4*Number(e._winNumLabel.label.string),i=e._winGold;C.default.NumAnimate(e._winNumLabel.label,.5,t,Number(i),1,1.3,function(){e._winNumLabel.label.string=g.default.divide(i,1e4),e._isPlayAward=!1})},.3)},t.prototype.createAnimateNode=function(e){return l(this,void 0,void 0,function(){var t,i=this;return r(this,function(n){switch(n.label){case 0:return this._winGold<=0?(console.warn("\u5154\u5b50\u6ca1\u6709\u8d62\u94b1"),[2]):[4,I.snRes.loadAsync("RabbitSlots","Prefabs/animateNode/"+e)];case 1:return(t=n.sent())?B.logd.warn("\u5154\u5b50\u52a0\u8f7d:"+e,"\u6210\u529f"):B.logd.warn("\u5154\u5b50\u52a0\u8f7d:"+e,"\u5931\u8d25"),this._isPlayAnimate=!0,this["_"+e]=this["_"+e]||cc.instantiate(t),null==this["_"+e].parent&&(this["_"+e].parent=this._ContentUpLayer),this["_"+e+"win"]=this["_"+e+"win"]||S.GetNodeByName(this["_"+e],"win"),this["_"+e+"winConten"]=this["_"+e+"winConten"]||S.GetNodeByName(this["_"+e],"winConten"),this["_"+e+"WinLabel"]=this["_"+e+"WinLabel"]||S.GetComByName(this["_"+e+"winConten"],"WinLabel",cc.Label),null==this["_"+e+"WinCloseBtn"]&&(this["_"+e+"WinCloseBtn"]=this["_"+e+"winConten"].getChildByName("WinCloseBtn"),b.default.addClick(this["_"+e+"WinCloseBtn"],this.onCloseWin,this)),this["_"+e+"WinTimeLabel"]=this["_"+e+"WinTimeLabel"]||this["_"+e+"WinCloseBtn"].getChildByName("WinTimeLabel").getComponent(cc.Label),null==this["_"+e+"WinCloseBtn"]&&(this["_"+e+"WinCloseBtn"]=this["_"+e+"winConten"].getChildByName("WinCloseBtn"),b.default.addClick(this["_"+e+"WinCloseBtn"],this.onCloseWin,this)),this._currWinNodeName=e,this.scheduleOnce(function(){i.playSpecialAnimate(e,i["_"+e],i["_"+e+"win"],i["_"+e+"winConten"],i["_"+e+"WinLabel"],i["_"+e+"WinCloseBtn"],i["_"+e+"WinTimeLabel"],!0)},.8),[2]}})})},t.prototype.startAutoSpin=function(e){var t=this;this._autoNum>0?(this._maxbetBtn.button.interactable=this._jianBtn.button.interactable=this._jiaBtn.button.interactable=!1,e=e||.1,this.scheduleOnce(function(){t.onSpinCallBack()},e)):this.onCancelAutoCallBack()},t.prototype.playSpecialAnimate=function(e,t,i,n,o,a,l,r){var s=this;switch(void 0===r&&(r=!1),t.active=i.active=!0,o.string="",i.getComponent(dragonBones.ArmatureDisplay)?i.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1):i.getComponent(sp.Skeleton)?"bigWinNode"==e?i.getComponent(sp.Skeleton).setAnimation(0,"animation_bw",!1):"megaWinNode"==e?i.getComponent(sp.Skeleton).setAnimation(0,"animation_mw",!1):"superWinNode"==e&&i.getComponent(sp.Skeleton).setAnimation(0,"animation_smw",!1):i.getComponent(cc.Animation).play(),e){case"bigWinNode":N.default.playEffectByClip(this.bigwin_sound_wClip),this.showCurAward(2);break;case"megaWinNode":N.default.playEffectByClip(this.megawin_sound_mClip),this.showCurAward(3);break;case"superWinNode":N.default.playEffectByClip(this.superwin_sound_mClip),this.showCurAward(4);break;default:N.default.playEffectByClip(this.normalwinClipAry[Math.floor(Math.random()*this.normalwinClipAry.length)])}var c=this._winGold,p=(this._currWinNodeName,.3);this.scheduleOnce(function(){n.active=!0,C.default.NumAnimate(s._goldLabel.label,.4,1e4*Number(s._goldLabel.label.string),1e4*Number(s._myGold),1,1,function(){s._goldLabel.label.string=s._myGold,s.requestBrokeData(Number(s._myGold),s._lastBetNum),b.default.showMoneyChangeWithDrawPopup(),s.requestBigRewardGiftData()}),C.default.NumAnimate(o,2,0,c,1,1.2,function(){o.string=g.default.divide(c,1e4),s._isPlayAward=!1,"megaWinNode"!=e&&"bigWinNode"!=e&&"superWinNode"!=e||(a.active=!0);var t=c;if(C.default.NumAnimate(s._winNumLabel.label,.4,0,Number(t),1,1,function(){s._winNumLabel.label.string=g.default.divide(t,1e4)}),s._countdown){var i=s._countdown;l.string=i+"",s.schedule(function(){i>0?(i--,l.string=i+""):s.onCloseWin(null)},1,s._countdown)}})},p)},t.prototype.onCloseWin=function(e){var t=this;N.default.playEffectByClip(this.btnTouchClip),this.unscheduleAllCallbacks();var i=this["_"+this._currWinNodeName].getChildByName("node");i.__show=!0,b.default.closeDialogAnimate(i,function(){t._isPlayAnimate=!1,t["_"+t._currWinNodeName].active=t["_"+t._currWinNodeName+"winConten"].active=t["_"+t._currWinNodeName+"WinCloseBtn"].active=!1,t["_"+t._currWinNodeName+"win"].getComponent(cc.Animation)&&(t["_"+t._currWinNodeName+"win"].getComponent(cc.Animation).setCurrentTime(0),t["_"+t._currWinNodeName+"win"].getComponent(cc.Animation).stop()),i.scale=1,1!=e&&t.judgeFinish()})},t.prototype.onCancelAutoCallBack=function(){e.prototype.onCancelAutoCallBack.call(this),this._autoNormalBg.active=!0,this._autoSelectBg.active=!1},t.prototype.onAutoCallBack=function(t){e.prototype.onAutoCallBack.call(this,t),this._autoNormalBg.active=!1,this._autoSelectBg.active=!0},t.prototype.onSpinTouchEnd=function(){e.prototype.onSpinTouchEnd.call(this),N.default.playEffectByClip(this.btnSpinClip)},t.prototype.onOpenRule=function(){return l(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return N.default.playEffectByClip(this.btnTouchClip),[4,I.snRes.loadAsync("RabbitSlots","Prefabs/ruleNode")];case 1:return(e=t.sent())?(B.logd.warn("\u5154\u5b50\u52a0\u8f7d\u89c4\u5219","\u6210\u529f"),cc.instantiate(e).parent=this.node):B.logd.warn("\u5154\u5b50\u52a0\u8f7d\u89c4\u5219","\u5931\u8d25"),[2]}})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),w.config.applicaion.isVScreenGame=!1},a([F(cc.AudioClip)],t.prototype,"btnSpinClip",void 0),a([F([cc.AudioClip])],t.prototype,"normalwinClipAry",void 0),a([F(cc.AudioClip)],t.prototype,"bigwin_sound_wClip",void 0),a([F(cc.AudioClip)],t.prototype,"megawin_sound_mClip",void 0),a([F(cc.AudioClip)],t.prototype,"superwin_sound_mClip",void 0),a([F(cc.AudioClip)],t.prototype,"frspStartClip",void 0),a([F(cc.AudioClip)],t.prototype,"frspEndClip",void 0),a([F(cc.AudioClip)],t.prototype,"frspBgmClip",void 0),a([F(cc.AudioClip)],t.prototype,"rabbitStartClip",void 0),a([F(cc.AudioClip)],t.prototype,"rabbitReadyClip",void 0),a([F(cc.Node)],t.prototype,"nodeTips",void 0),a([P],t)}(s.default);i.default=L,cc._RF.pop()},{"../../Script/BaseSlot/SlotBaseScene":void 0,"../../Script/BaseSlot/SlotEvent":void 0,"../../Script/Common/ChooseOneSprite":void 0,"../../Script/Core/Analytics/AnalyticsCfg":void 0,"../../Script/Core/Analytics/AnalyticsMgr":void 0,"../../Script/Core/Common/TipsPopup":void 0,"../../Script/Core/Config/LanguageCfg":void 0,"../../Script/Core/Event/GlobalEvent":void 0,"../../Script/Core/Module/GameData":void 0,"../../Script/Core/Net/SocketMgr":void 0,"../../Script/Core/Scene/SceneMgr":void 0,"../../Script/Core/Tool/CommonFun":void 0,"../../Script/Core/Tool/CommonTool":void 0,"../../Script/Core/Tool/GetComByName":void 0,"../../Script/Core/Tool/MathTool":void 0,"../../Script/Core/Tool/SoundMgr":void 0,"../../Script/app/config":void 0,"../../Script/app/creator":void 0,"../../Script/app/logd":void 0,"../../Script/app/sn-res":void 0,"./RabbitSlotsContentCom":"RabbitSlotsContentCom"}]},{},["RabbitSlotsContentCom","RabbitSlotsItemCom","RabbitSlotsRowCom","RabbitSlotsScene"]);